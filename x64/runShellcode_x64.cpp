#include <iostream>
#include <cstring>
#include <unistd.h>
#include <sys/mman.h>

unsigned char shellcode[] = {0xeb, 0x35, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbf, 0x01, 0x00, 0x00, 0x00, 0x5e, 0xe8, 0x0c, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x48, 0x31, 0xdb, 0xcd, 0x80, 0x56, 0xba, 0x00, 0x00, 0x00, 0x00, 0x48, 0xff, 0xce, 0x48, 0xff, 0xc2, 0x48, 0xff, 0xc6, 0x80, 0x3e, 0x00, 0x75, 0xf5, 0x48, 0xff, 0xca, 0x5e, 0xc3, 0xe8, 0xc6, 0xff, 0xff, 0xff, 0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x74, 0x68, 0x65, 0x72, 0x65, 0x21, 0x0a, 0x0d, 0x00};

int main() {
    int length = sizeof(shellcode);
    void *exec_mem = mmap(NULL, length, PROT_EXEC | PROT_WRITE | PROT_READ, MAP_ANON | MAP_PRIVATE, -1, 0);
    memcpy(exec_mem, shellcode, length);

    void (*shellcode_ptr)() = (void (*)()) exec_mem;
    shellcode_ptr();

    munmap(exec_mem, length);
    return 0;
}
