#include <iostream>
#include <cstring>
#include <unistd.h>
#include <sys/mman.h>

unsigned char shellcode[] = {0xeb, 0x2f, 0xb8, 0x04, 0x00, 0x00, 0x00, 0xbb, 0x01, 0x00, 0x00, 0x00, 0x59, 0xe8, 0x0e, 0x00, 0x00, 0x00, 0xcd, 0x80, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xbb, 0x00, 0x00, 0x00, 0x00, 0xcd, 0x80, 0x51, 0xba, 0x00, 0x00, 0x00, 0x00, 0x49, 0x42, 0x41, 0x80, 0x39, 0x00, 0x75, 0xf9, 0x4a, 0x59, 0xc3, 0xe8, 0xcc, 0xff, 0xff, 0xff, 0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x74, 0x68, 0x65, 0x72, 0x65, 0x21, 0x0a, 0x0d, 0x00};

int main() {
    int length = sizeof(shellcode);
    void *exec_mem = mmap(NULL, length, PROT_EXEC | PROT_WRITE | PROT_READ, MAP_ANON | MAP_PRIVATE, -1, 0);
    memcpy(exec_mem, shellcode, length);

    void (*shellcode_ptr)() = (void (*)()) exec_mem;
    shellcode_ptr();

    munmap(exec_mem, length);
    return 0;
}
